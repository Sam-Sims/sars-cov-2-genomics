<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>SARS-CoV-2 Genomics</title>

<script src="site_libs/header-attrs-2.16/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>







<link rel="stylesheet" href="assets/styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">UoC BioinfoTraining</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="101-setup.html">
    <span class="fa fa-gear"></span>
     
    Setup
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-file-lines"></span>
     
    Materials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">The Unix Shell</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="02a-unix_intro.html">Intro to Unix</a>
        </li>
        <li>
          <a href="02b-unix_files_directories.html">Files and Directories</a>
        </li>
        <li>
          <a href="02c-unix_text_manipulation.html">Text Manipulation</a>
        </li>
        <li>
          <a href="02d-unix_pipes.html">Combining Commands &amp; Writing Scripts</a>
        </li>
      </ul>
    </li>
    <li>
      <a href="01-intro.html">SARS-CoV-2 Genomic Surveillance</a>
    </li>
    <li>
      <a href="03-intro_ngs.html">Intro to NGS Data</a>
    </li>
    <li>
      <a href="04-consensus.html">Consensus Assembly</a>
    </li>
    <li>
      <a href="05-lineage_analysis.html">Lineages and Variants</a>
    </li>
    <li>
      <a href="06-phylogeny.html">Building Phylogenies</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-book"></span>
     
    Extras
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="102-unix_cheatsheet.html">Unix Cheatsheet</a>
    </li>
    <li>
      <a href="106-file_formats.html">Common File Formats</a>
    </li>
    <li>
      <a href="104-wsl_windows.html">Windows Subsystem for Linux</a>
    </li>
    <li>
      <a href="105-vs_code.html">Visual Studio Code</a>
    </li>
    <li>
      <a href="103-tools_and_resources.html">SARS-CoV-2 Resources</a>
    </li>
  </ul>
</li>
<li>
  <a href="100-homework.html">
    <span class="fa fa-pencil"></span>
     
    Homework
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/cambiotraining/sars-cov-2-genomics">
    <span class="fa fa-brands fa-github"></span>
     
    Github
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">




</div>


<div id="introduction-to-sars-cov-2-genomics" class="section level1">
<h1>Introduction to SARS-CoV-2 Genomics</h1>
<div class="highlight">
<p>This course will teach you how to analyse sequencing data from SARS-CoV-2 amplicon samples to generate consensus sequences ready to be uploaded to public databases such as GISAID and to be used in other downstream analysis such as variant annotation and phylogeny. We will teach the use of a standardised analysis pipeline, which can work with both Illumina and Nanopore data. We will also cover how to assign sequences to lineages, identify variants of interest/concern and produce visualisations to communicate your findings. Along the way, you will gain foundational bioinformatic skills, including the use of the Unix command line and learn to write simple scripts to ensure your analysis is reproducible.</p>
</div>
<p><strong>Learning Goals:</strong></p>
<ul>
<li>Recognise the uses of genomic surveillance to inform public health actions during a pandemic.</li>
<li>Assemble high-quality SARS-CoV-2 genome sequences from raw sequencing data.</li>
<li>Assign consensus sequences to lineages and identify variants of interest/concern.</li>
<li>Capture high-quality metadata, recognising its impact on downstream analyses.</li>
<li>Construct phylogenetic trees to contextualise new samples in a set of background samples.</li>
<li>Produce visualisations to communicate these findings and help inform public health action.</li>
</ul>
<p><strong>Learning Objectives:</strong></p>
<p>By the end of this course, learners should be able to:</p>
<ul>
<li>Enumerate examples of how the genomic surveillance of SARS-CoV-2 has impacted public health decisions during the ongoing pandemic.</li>
<li>Contrast the different technologies and protocols commonly used for SARS-CoV-2 sequencing, including the pros and cons of each.</li>
<li>Understand the importance and uses of metadata such as geolocation, date of collection and protocols used.</li>
<li>Use the Unix command line to navigate a filesystem, manipulate files, launch programs and write scripts for reproducible analysis.</li>
<li>Recognise the structure of common sequence file formats in bioinformatics and run basic quality control tools on them.</li>
<li>Summarise the steps in the bioinformatic pipeline used for assembling SARS-CoV-2 genomes from high-throughput amplicon sequencing.</li>
<li>Apply the <code>nf-core/viralrecon</code> <em>Nextflow</em> pipeline to generate a consensus sequence from Illumina and Nanopore data.</li>
<li>Assess the quality of the consensus sequences and identify high-quality sequences suitable for downstream analyses and submission to public databases.</li>
<li>Assign sequences to lineages and variants using <code>pangolin</code> and <code>nextclade</code>.</li>
<li>Interactively explore data and produce visualisations using <em>Nextstrain</em> tools.</li>
<li>Manage and install bioinformatics software using <em>Conda</em> and set up <em>Nextflow</em> workflows.</li>
</ul>
<div id="target-audience" class="section level2">
<h2>Target Audience</h2>
<p>This course is aimed at life scientists interested in the bioinformatic analysis of SARS-CoV-2 genomic data. In particular it will benefit those working in SARS-CoV-2 sequencing facilities, such as public health authority labs. Those with prior experience in bioinformatics may also benefit from the later sessions of the course, which cover specific tools for SARS-CoV-2 (earlier sessions of the course cover basic skills such as the Unix command line and could be skipped by experienced bioinformaticians).</p>
</div>
<div id="prerequisites" class="section level2">
<h2>Prerequisites</h2>
<p>We assume no prior bioinformatics experience or experience with the tools introduced in this course. An elementary knowledge of molecular and viral biology is assumed (concepts such as: DNA, RNA, PCR, primers, SNPs).</p>
<!-- 
## Schedule 

:::warning
This is a rough working draft to run across half-day sessions (3-4h long).
Only after the first run will we have a more concrete idea of timings.
:::

| | Session | Duration (estimate) |
|--:|:--|:--|
| Day 1 | [Introduction to SARS-CoV-2 Genomics](01-intro.html) | 1h |
|       | [Introduction to the Unix Command Line](02-unix.html) | 3h |
| Day 2 | [Introduction to NGS Sequencing](03-intro_ngs.html) | 2h |
|       | [SARS-CoV-2 Reference-based Consensus Assembly](04-artic_nextflow.html) | 2h |
| Day 3 | [Lineage Assignment and Variant Classification](05-lineage_assignment.html) | 2h |
|       | [Building phylogenetic trees](06-phylogeny.html) | 2h |
| Day 4 | [Managing and Installing Software](07-nextflow_conda_setup.html) | 2h |
|       | Q&A | 1h |
 -->
</div>
<div id="acknowledgements" class="section level2">
<h2>Acknowledgements</h2>
<p>These materials have been developed as a collaboration between the <a href="https://bioinfotraining.bio.cam.ac.uk/">Bioinformatics Training Facility</a> at the University of Cambridge and the <a href="https://www.gov.uk/guidance/new-variant-assessment-platform">New Variant Assessment Platform (NVAP)</a> program from the <em>UK Health Security Agency</em>.</p>
<p>Our partners also include <a href="https://www.cogconsortium.uk/cog-train/about-cog-train/">COG Train</a>. We also thank the wider community for publicly sharing training resources, including:</p>
<ul>
<li>The <a href="https://www.youtube.com/channel/UCdiGIIyryQL3x-Og5uiY1rw">workshop video series from <em>CLIMB BIG DATA</em></a>.</li>
<li>The <a href="https://carpentries.org/">Carpentries</a> project, in particular for their <a href="https://swcarpentry.github.io/shell-novice/">Unix Shell</a> lesson, which we adapted for this workshop.</li>
</ul>
</div>
<div id="citation-authors" class="section level2">
<h2>Citation &amp; Authors</h2>
<p>You can cite these materials as:</p>
<p>Tavares H, Kumar A, Castle M &amp; UKHSA New Variant Assessment Platform Team (2022) “cambiotraining/sars-cov-2-genomics: Introduction to Sars-CoV-2 Genomics”, <a href="https://cambiotraining.github.io/sars-cov-2-genomics" class="uri">https://cambiotraining.github.io/sars-cov-2-genomics</a></p>
<p>Or, in BibTeX format:</p>
<pre><code>@Misc{,
  author = {Tavares, Hugo and Kumar, Ankit and Castle, Matt and UKHSA New Variant Assessment Platform Team},
  title = {cambiotraining/sars-cov-2-genomics: Introduction to Sars-CoV-2 Genomics},
  month = {March},
  year = {2022},
  url = {https://cambiotraining.github.io/sars-cov-2-genomics},
}</code></pre>
<p><strong>Please make sure to include a link to the materials in the citation.</strong> (we will add a DOI in due time)</p>
<p>The contributing members from University of Cambridge Bioinformatics Training Facility team are:</p>
<ul>
<li>Matt Castle, Bioinformatics Training Manager</li>
<li>Hugo Tavares, Senior Teaching Associate</li>
<li>Ankit Kumar, Teaching Assistant</li>
</ul>
<p>The UKHSA’s NVAP Team members that supported these materials are:</p>
<ul>
<li>Dr Leena Inamdar, NVAP Programme Lead and Global Health Lead</li>
<li>Dr Babak Afrough, Senior Project Manager</li>
<li>Aude Wilhelm, Senior Epidemiology Scientist</li>
<li>Richard Meyers, Data Analytics Surveillance Head Bioinformatician</li>
<li>Sam Sims, Bioinformatician</li>
<li>Kate Edington, Bioinformatician</li>
<li>Constantina Laou, Specialist Lab Advisor</li>
</ul>
</div>
</div>

<!DOCTYPE html>
<html>
<head>
<style>
* {
  box-sizing: border-box;
}

.img-container-left {
  float: left;
  width: 33.33%;
  padding: 15px;
}

.img-container-right {
  float: right;
  width: 33.33%;
  padding: 15px;
}

.clearfix::after {
  content: "";
  clear: both;
  display: table;
}
</style>
</head>
<body>

<hr>
<div class="clearfix">
  <div class="img-container-left">
    <img src="assets/img/logo_btf.png" alt="UoC Bioinformatics Training Facility" style="width:100%">
  </div>
  <div class="img-container-right">
    <img src="assets/img/logo_ukhsa.svg" alt="UK Public Health England" style="width:40%">
  </div>
</div>

</body>
</html>





</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
